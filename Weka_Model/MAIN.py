import subprocess, sys,time ,xlrd ,os,csv, shutil
import os
from os.path import join
# from android_malware.models import Apk

def MAIN(apk_list):
    outputrow=[]

    cmd1="java -classpath /home/ymlab/PycharmProjects/untitled4/Weka_Model/weka-3-9-2/weka.jar weka.filters.unsupervised.attribute.Remove -R 1 -i Weka_Model/permissionforTest.csv -o Weka_Model/test2.arff"
    cmd2="java -classpath /home/ymlab/PycharmProjects/untitled4/Weka_Model/weka-3-9-2/weka.jar weka.classifiers.trees.RandomForest -x -T Weka_Model/test2.arff -l Weka_Model/TESTNEW.model -classifications weka.classifiers.evaluation.output.prediction.PlainText > Weka_Model/output.csv"
    os.system(cmd1)
    os.system(cmd2)
    data2=open("Weka_Model/output.csv", mode='r', encoding='utf-8')
    lines = data2.readlines()
    data2.close()
    result_time = time.strftime("%Y%m%d%H%M%S")
    print(apk_list)


    for i in range(len(lines)):
        if i >7:
            resultstring=lines[i-1]
            result=resultstring.find('benign')
            if result>0:
                apk_result = "benign"
                print("benign")
            else:
                apk_result = "malware"
                print("malware")

    return apk_result, result_time



